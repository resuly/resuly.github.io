---
layout: post
title: "从零开始组建 1080TI 矿机"
date: "2016-12-20 17:41:30 +0800"
author: "resuly"
header-img: "img/post-bg-gtx.jpg"
catalog: true
tags:
  - RNN
  - 随机森林
  - 决策树
  - 共享单车
  - 神经网络
---

矿机通过处理大量的运算任务，帮助虚拟货币网络完成区块的计算。在达到网络的计算要求后，可以获得相应的虚拟货币作为奖励，该过程被人们戏称为“挖矿”。这里的矿就是指虚拟货币，它们可以通过各种交易平台兑换成其他货币。受朋友所托，最近从头到尾帮他组建了一台这样的机器。本文将介绍如何利用 1080 TI 显卡进行挖矿，从硬件选购、安装、系统调试等方面，详细介绍整个组装的流程。

## 硬件清单

**显卡**

在挖矿的时候，所有的数据都交给显卡进行计算，显卡的运算能力往往决定了你处理这些数据的速度，从而决定了你的设备在矿池中的权重，也就是通常所说的shares，你所能提供的算力越多，自然在矿池中分得的收益也就越多。在网上搜索这个型号的显卡，你会发现有很多不同的厂商都在生产。

首先请出我们的主人公 1080 TI，九段级的显卡，性能强劲。到底应该如何选择这些不同的显卡品牌呢？答案是选择价格低的。其实他们的主频还有核心芯片都是一样的，只不过在风扇散热设计，灯光效果等方面有所区别，对于很多游戏玩家而言，这些区别就是信仰，而信仰往往意味着更多的银子。所以对我们拿来挖矿而言，选择一个性价比比较高的显卡就可以了。在这里，我们买到的是耕升系列的显卡。

![](/img/in_post/2018/05/TB2nDaPjlTH8KJjy0FiXXcRsXXa_16475161.jpg)

内存颗粒与超频问题。我们都知道显卡里面有很多个gpu芯片进行运算，显卡上面的内存颗粒通常由不同的芯片工厂进行代工生产，比如说镁光、三星、海力士等等。而这些厂家生产出来的芯片，在后期对其超频的时候有一定的区别。从其他系列显卡以及网友的的经验来看，比如说AMD的R470/480，R570/580  系列显卡，Nvidia家的GTX 1060、 GTX 1070系列显卡，如果他们使用了三星生产的内存颗粒，往往超频性能更好。对于1080 ti 而言，暂时还并没有相关的测试。

![](/img/in_post/2018/05/20180520175741.jpg)

如何查看你的颗粒厂家呢？很简单，我们直接打开GPU-Z，选择显卡，然后查看 Memory Type 就可以了，这里显示是镁光（Micron）生产的。

**主板**

对于显卡矿机而言，我们首先要考虑的是主板能够支持几块显卡。你想组一台6块显卡的矿机？或者8块？或者12块？很显然，一般家用的主板是不支持插入那么多块显卡的，一般而言，六块以上的显卡需要通过转接线的方式进行连接。也就是使用PCE-E延长线，把PCI-E X1的插槽转接为PCI-E X16的插槽，然后在插上显卡。一般非公版的显卡，外形设计都比较厚重，即使主板上支持多个PCI-E X16插槽，也很难将这些显卡同时插入主板。不过近年来有专门为挖矿设计的加长版显卡，插槽与插槽之间的距离都比较大，不过这类主板往往是小厂家制作，质量不能保证。
![](/img/in_post/2018/05/t250-btc.jpg)
在这里我们选择了映泰的挖矿主板系列 TB250-BTC，支持六块显卡。图中标注的部分就是六个插槽，值得注意的是，黄色的PCI-E X16插槽也可以当PCI-E X1来用。该系列主板的好处就是，映泰已经为挖矿专门做了一些设置，配置起来并不是那么麻烦。另外还有一款 PRO 的产品，同时最多支持12个显卡插槽，如下图所示。当然啦，具体型号可以根据你的需要来定，微星技嘉等主板也是不错的。
![](/img/in_post/2018/05/9690049_dsc00520_thumb.jpg)

**电源**

其实最耗电的是显卡，先查一下各个显卡型号的最大使用功率，然后把它们加起来。其他部分的功率其实消耗不大，可以按照600瓦或者800瓦计算。所以你买电源的时候，电源支持的最大功率一定要大于你计算出来的功率，如果是六块1080ti的话，那肯定是要上两个电源了。
![](/img/in_post/2018/05/9690049_dsc00518_thumb-1.jpg)

如果要买两个电源，需要考虑两个电源同时启动的问题。需要把两个电源接起来，一个主电源一个辅助电源，分别给不同的部件进行供电。在这里可以选择一种叫做电源启动线的东西，轻松把两个电源串起来接到主板上，安装简单，成本大约十几块钱（感谢老邹同学的指点）。
![](/img/in_post/2018/05/20180124222140-768x508.jpg)

在购买电源的时候，一定要问好商家是否支持其中一个店员当作辅助电源，并且跟商家沟通你的组装方案，看看电源是不是能带得动。我们这次为了保险起见，选择了两个1600瓦的电源。

**显卡转接线**

显卡转接线就是把PCI-E X1的插槽转接为PCI-E X16的插槽的东西，它本身也是需要供电的，所以买的时候最好选择6PIN的，一般会带一个SATA电源的转接线，两种电源接口都能用，避免了电源上接口不够的局面。
![](/img/in_post/2018/05/TB2MkRiuNRDOuFjSZFzXXcIipXa_1736826123-1.jpg)

**CPU**

CPU真的不用买太好的，但也不能买太差的。我第一次用了一个大概一百多块钱的CPU，虽然可以带动整个挖矿系统的运转，但CPU占用率一直在90%左右，让人十分担心。后来果断换了个300多块钱的CPU，CPU的负载一下子就降下来了，还是比较省心的。下面是CPU的性能天梯图，选一个中端的、性价比高的CPU就可以了，比如 G4600。
![](/img/in_post/2018/05/CPUtianti-30.jpg)


**内存**

挑一个便宜的4GB内存装上即可。

**硬盘**

挖矿对硬盘的大小没有太多要求，一般选择一个60GB的固态硬盘就足够了。

**机箱、机架、风扇**

机箱和机架往往包含了开关等配件，机箱的好处就是比较容易安装，机架组装起来麻烦一些。那么这两种哪一个散热更好呢？因为缺乏相关的测试，目前也不能给出明确的结果。

具体选择哪一种由你的喜好来定，当然如果没有这些也可以直接扔在地上先进行测试。这里笔者选择了机架进行组装，收货时拿到一大堆钢管和几包螺丝，内心一开始是有点无助的。建议购买前先咨询好商家是否有说明书、组装难度等等。可以根据实际的运行情况选择合适的风扇进行散热。

**其他**

准备好插线板，网线或者无线网卡，DVI显示器连接线，螺丝刀，显示器，鼠标键盘等设备。

## 硬件组装
建议先不要安装独立显卡，使用集成显卡连接显示器，线完成BIOS的设置工作，再安装调试6块集成显卡。请直接看下面的BIOS设置部分。

这一步就是把你买到的配件全部都组装到一起，和普通的组装电脑并没有太多的区别。首先安装CPU，CPU风扇，然后安装内存硬盘。

![](/img/in_post/2018/05/20180124225010.jpg)

接电源的时候注意CPU电源电压是不一样的，其他的按照说明书来就可以。最终的组装效果如下:

![](/img/in_post/2018/05/IMG_6883-1024x758.jpg)

如果一切顺利的话，你按下电源键就可以启动机器了。没有正确启动也不要担心，各个部件在通电的情况下即使错误安装，也没有那么容易损坏。请仔细检查电源有没有接错，或者什么部件没有正确的安装。下一步就是进行主板的BIOS的设置了，开机按DEL键进入。

## BIOS设置

这里使用的是映泰的主板，不同厂家的主板可能设置界面有所不同，请大家注意。
![](/img/in_post/2018/05/bios1-1024x375.jpg)
首先当然是将系统的语言调成中文了，可以方便我们的操作。在Main界面选择System Language为简体中文。
![](/img/in_post/2018/05/bios2.jpg)
第二步，进入芯片组，将 Mining Mode 改为 Above 6x VGA。

第三步，进入芯片组，选择 System Agent 设置，将内部图形改成启用，将主显示改为IGFX。这样就使用集成显卡输出显示器画面了。
![](/img/in_post/2018/05/bios4.jpg)
![](/img/in_post/2018/05/bios5.jpg)
最后，保存并退出。

## 安装操作系统
这里我们选择windows10操作系统，可以到windowsiso.net这个网站选择你喜欢的系统镜像版本，这里推荐64位的1703版本，十分稳定。下载好镜像后，制作U盘启动工具，推荐使用UltraISO。

首先打开下载好的系统镜像文件。
![](/img/in_post/2018/05/092318001902797.jpg)
选择写入硬盘镜像。
![](/img/in_post/2018/05/092318018939010.jpg)
将ISO镜像写入到U盘中。
![](/img/in_post/2018/05/092318034559265.jpg)
然后从BIOS选择从U盘优先启动，安装操作系统，一步步确认就可以了。

## 驱动安装
- windows激活
- 安装主板驱动，映泰的驱动在这里：[http://www.biostar.cn/app/en-us/mb/index.php](http://www.biostar.cn/app/en-us/mb/index.php)
- 安装显卡驱动，英伟达的驱动在这里：[http://www.nvidia.cn/Download/index.aspx?lang=cn](http://www.nvidia.cn/Download/index.aspx?lang=cn)

## 系统设置
对于一个矿机而言，长期稳定的工作尤为重要。所以我们要针对该系统，进行一些专项设置。

**自动登录**

如果机器在遇到断电或者其他需要重启的情况，我们是不希望他自己卡在启动界面等人来输入密码的。我们需要它能够自动进入系统并且运行挖矿程序。所以我们需要设置系统账户，不需要输入密码能够自动登录。

在开始菜单，点击右键，选择运行，输入 “netplwiz”命令，点击确定。
![](/img/in_post/2018/05/se.jpg)

取消选择，“要使用本计算机，用户必须输入用户名和密码”

点击应用，然后会弹出一个窗口，让你输入当前用户的密码，输入密码并确认。

**电源设置 防止进入睡眠模式**

在windows的默认设置下，如果用户没有任何操作，系统将在30分钟后进入睡眠状态。很显然，我们的矿机可不能进入睡眠状态，通过以下步骤修改这个默认设置：

开始菜单右键，选择电源设置，将关闭显示器和睡眠均选为从不。

![](/img/in_post/2018/05/setpower.jpg)

**关闭系统更新**

Windows 10 系统引入了一种颇具争议的强制更新策略，在你的矿机重启的时候系统将自动安装升级补丁，很让人讨厌。我们希望系统启动之后就自动开始挖矿，直接跳过系统更新。 网上有很多种相关的方法，这里介绍利用组策略的方法。

在开始菜单，点击右键，选择运行，输入 “gpedit.msc”命令，点击确定。

寻找以下路径：计算机配置 -> 管理模板 -> windows组件 -> windows更新

![](/img/in_post/2018/05/setupdate-1.jpg)

**分配至少16GB的虚拟内存**

一些挖矿软件的作者建议分配16GB以上的虚拟内存，因为我们购买的4GB内存有时候会遇到性能不足的问题，通过虚拟内存可以有效的改善。（之前在测试一个挖矿软件的时候，只使用4GB的物理内存，结果算力低得惊人，设置了虚拟内存之后这个问题马上就解决了）。设置方法如下：

开始菜单右键，选择系统，点击系统信息，高级系统设置
![](/img/in_post/2018/05/1516809559-768x500.jpg)
选择高级，性能设置，再选择高级，在虚拟内存菜单下面点击更改
![](/img/in_post/2018/05/15168096831-768x587.png)
选择自定义大小并输入16384，点击设置。
![](/img/in_post/2018/05/15168097361.png)

**关闭一些视觉效果**

系统会默认开启一些视觉特效，可能会轻微增加系统的运行负担。我们在挖矿的时候并不需要这些视觉效果，所以将它们关闭即可。

与上一步骤相同，在性能选项中，选择视觉效果，然后选择调整为最佳性能，点击应用。


## 远程控制
如果数量不是很多，这里推荐使用免费的 Teamviewer 即可。

## 挖矿软件

对于1080ti来说，目前挖Zcash是相对最合算的，六块显卡的算力，一个月大约能够挖到1.9个币。当然你也可以尝试去挖其他的币种。

首先你得准备好一个钱包地址，然后下载对应的挖矿软件对接矿池，绑定你的钱包地址，这样就可以从矿池的监控信息中看到矿机的实际运算状态了。

## 超频
一说到超频，很多人认为就是烧坏显卡的一种手段。实际上这里的超频并不是和极限游戏玩家那样超频一样，我们是需要针对挖矿这种使用条件，对显卡的风扇、主频进行一系列优化设置，让这些显卡能够以最高效方式工作。通过超频软件对显卡进行正确的设置，往往能降低显卡温度并提高算力。一般使用MSIAfterburner调试即可。

最后，献上6卡 Rig 的运行视频（已顺利寄给朋友，goodbye 小怪兽）：

<video width="650" autoplay loop muted>
  <source src="/img/in_post/2018/05/WeChat_20180520182458.mp4" type="video/mp4">
</video>
